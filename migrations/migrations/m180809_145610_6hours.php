<?php

/**
 * Class m180809_145610_6hours
 */
class m180809_145610_6hours extends \app\classes\Migration
{
    /**
     * Up
     */
    public function safeUp()
    {
        /**
         * 2018-08-10 02:00:00	113	    2018-08-09 22:00:00
         * 2018-08-10 03:00:00	968	    2018-08-09 21:00:00
         * 2018-08-10 04:00:00	8	    2018-08-09 20:00:00
         * 2018-08-10 05:00:00	46	    2018-08-09 19:00:00
         * 2018-08-10 06:00:00	18	    2018-08-09 18:00:00
         * 2018-08-10 10:00:00	13	    2018-08-09 14:00:00
         * 2018-09-01 02:00:00	362	    2018-08-31 22:00:00
         * 2018-09-01 03:00:00	47292	2018-08-31 21:00:00
         * 2018-09-01 04:00:00	95	    2018-08-31 20:00:00
         * 2018-09-01 05:00:00	688	    2018-08-31 19:00:00
         * 2018-09-01 06:00:00	707	    2018-08-31 18:00:00
         * 2018-09-01 10:00:00	117	    2018-08-31 14:00:00
         * 2019-03-01 03:00:00	1	    2019-02-28 21:00:00
         * 2019-04-01 01:00:00	3	    2019-03-31 23:00:00
         * 2019-04-01 03:00:00	12	    2019-03-31 21:00:00
         * 2019-04-01 05:00:00	1	    2019-03-31 19:00:00
         * 2019-05-01 02:00:00	1	    2019-04-30 22:00:00
         * 2019-05-01 03:00:00	6	    2019-04-30 21:00:00
         * 2019-06-01 03:00:00	12	    2019-05-31 21:00:00
         * 2019-07-01 02:00:00	2	    2019-06-30 22:00:00
         * 2019-07-01 03:00:00	14	    2019-06-30 21:00:00
         * 2019-08-01 03:00:00	3	    2019-07-31 21:00:00
         * 2019-08-01 10:00:00	1	    2019-07-31 14:00:00
         */
        $sql = <<<SQL
UPDATE `uu_account_tariff`
SET account_log_period_utc = account_log_period_utc - INTERVAL hour(account_log_period_utc) * 2 HOUR
WHERE
HOUR (account_log_period_utc) > 0
AND HOUR (account_log_period_utc) < 12
AND account_log_period_utc > NOW() 
SQL;

        $this->execute($sql);
    }

    /**
     * Down
     */
    public function safeDown()
    {
        // всё что можно было поломать, уже сломано
    }
}
