<?php


class NetChecker
{
    public static $nets = array(
        //Москва
        '99'=>array(
                    '94.25.144.0/20', 
                    '94.25.160.0/19',
                    '109.188.80.0/20', 
                    '178.176.0.0/15'
                ),
        //Санкт-Петербург
        '98'=>array(
                    '109.188.128.0/17',
                    '178.178.0.0/18',
                    '94.25.192.0/19',
                    '188.162.64.0/21'
                ),
        //Сочи
        '82'=>array(
                    '178.179.0.0/19',
                    '188.162.128.0/19',
                    '94.25.131.0/24',
                    '109.188.64.0/21'
                ),
        //Уфа
        '84'=>array(
                    '188.162.200.0/21',
                    '188.162.208.0/20',
                    '178.179.32.0/19',
                    '178.179.64.0/18',
                    '178.179.128.0/18',
                    '178.179.192.0/19',
                    '94.25.131.0/24',
                    '109.188.64.0/21'
                ),
        //Краснодар
        '97'=>array(
                    '188.162.162.0/23',
                    '188.162.164.0/22',
                    '94.25.131.0/24'
                )
        );

    public function check($ip = '')
    {
        $ip_sum = netmask_to_ip_sum($ip);
        foreach (self::$nets as $region=>$ns) {
            $ips = iplist_make($ns);
            if (iplist_check($ips, $ip_sum[0])) return $ns;
        }
        return array($ip . '/32');
    }

}

?>
